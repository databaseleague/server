--source include/have_innodb.inc
--source include/have_sequence.inc

let SEARCH_FILE = $MYSQLTEST_VARDIR/log/mysqld.1.err;

SET GLOBAL innodb_log_file_size=4194304;
SHOW VARIABLES LIKE 'innodb_log_file_size';
SELECT global_value FROM information_schema.system_variables
WHERE variable_name = 'innodb_log_file_size';

CREATE TABLE t (
  a INT PRIMARY KEY AUTO_INCREMENT,
  b CHAR(255) NOT NULL)
ENGINE=INNODB;

INSERT INTO t SELECT NULL, REPEAT('a', 255) FROM seq_1_to_20000;

--let $restart_parameters=--innodb-log-file-size=4194304
--source include/restart_mysqld.inc

SHOW VARIABLES LIKE 'innodb_log_file_size';
let SEARCH_PATTERN = InnoDB: innodb_log_file_size changed to 4194304;
--source include/search_pattern_in_file.inc

SET GLOBAL innodb_log_file_size=5242880;
SHOW VARIABLES LIKE 'innodb_log_file_size';
SELECT global_value FROM information_schema.system_variables
WHERE variable_name = 'innodb_log_file_size';

--let $restart_parameters=
--source include/restart_mysqld.inc

SHOW VARIABLES LIKE 'innodb_log_file_size';
let SEARCH_PATTERN = InnoDB: innodb_log_file_size changed to 5242880;
--source include/search_pattern_in_file.inc

DROP TABLE t;
